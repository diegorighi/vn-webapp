# =============================================================================
# PROD PROFILE - PostgreSQL (RDS) + AWS Cognito
# =============================================================================

spring:
  datasource:
    url: jdbc:postgresql://${DB_HOST}:${DB_PORT:5432}/${DB_NAME}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
  flyway:
    enabled: true
    locations: classpath:db/migration
  graphql:
    path: /graphql
    graphiql:
      enabled: false  # Disabled in production

# =============================================================================
# SECURITY - AWS Cognito
# =============================================================================
security:
  disabled: false

spring.security.oauth2.resourceserver.jwt:
  # AWS Cognito issuer URI format: https://cognito-idp.{region}.amazonaws.com/{userPoolId}
  issuer-uri: https://cognito-idp.${AWS_REGION:sa-east-1}.amazonaws.com/${COGNITO_USER_POOL_ID}
  jwk-set-uri: https://cognito-idp.${AWS_REGION:sa-east-1}.amazonaws.com/${COGNITO_USER_POOL_ID}/.well-known/jwks.json

# =============================================================================
# AWS COGNITO CONFIG
# =============================================================================
cognito:
  user-pool-id: ${COGNITO_USER_POOL_ID}
  web-client-id: ${COGNITO_WEB_CLIENT_ID}
  region: ${AWS_REGION:sa-east-1}

# =============================================================================
# KMS - AWS KMS for production encryption
# =============================================================================
kms:
  provider: aws
  aws-key-arn: ${KMS_KEY_ARN}

# =============================================================================
# LOGGING - Production level
# =============================================================================
logging:
  level:
    root: WARN
    org.springframework.security: WARN
    com.vanessaviagem: INFO
  pattern:
    console: '{"timestamp":"%d{ISO8601}","level":"%p","logger":"%c","message":"%m","thread":"%t"}%n'
